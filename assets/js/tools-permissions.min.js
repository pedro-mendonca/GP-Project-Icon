jQuery(document).ready(function($){var userLogin=gpToolbox.user_login,userLocale=gpToolbox.user_locale,gpToolboxTablePermissionAdmin=$("table.gp-table.gp-project-icon.tools-permission-admin"),gpToolboxTablePermissionValidator=$("table.gp-table.gp-project-icon.tools-permission-validator"),glotpressAdmin=gpToolbox.admin,permissionAdminsRows=$(gpToolboxTablePermissionAdmin).find("tbody tr"),permissionValidatorsRows=$(gpToolboxTablePermissionValidator).find("tbody tr");function permissionDelete(permissionType,permissionID){var tr=$("table.gp-table.gp-project-icon.tools-permission-"+permissionType).find('tbody tr[gptoolboxdata-permission="'+permissionID+'"]'),td=$(tr).find("td.action"),notice=$(td).find("div.progress-notice"),button=$(td).find("button.delete"),td=$(td).find("span.duplicate");$(button).hide().attr("disabled",!0),$(td).hide(),$(notice).text(wp.i18n.__("Deleting...","gp-project-icon")).fadeIn(),$.ajax({url:wpApiSettings.root+"gp-project-icon/v1/permissions/"+permissionID+"/-delete",type:"POST",data:{_wpnonce:gpToolbox.nonce},success:function(response){var permissionsCount=$("p#permission-"+permissionType+"-count span.count").text();!0===response.deleted?($(tr).fadeOut(),0<(permissionsCount-=1)?$("p#permission-"+permissionType+"-count").html(sprintf(wp.i18n._n("%s Permission found.","%s Permissions found.",permissionsCount,"gp-project-icon"),'<span class="count">'+new Intl.NumberFormat(userLocale.slug).format(permissionsCount)+"</span>")):($("p#permission-"+permissionType+"-count").text(wp.i18n.__("No permissions found.","gp-project-icon")),$("div.permission-"+permissionType+"-filter").fadeOut(),$("table.gp-table.gp-project-icon.tools-permission-"+permissionType).fadeOut())):($(notice).hide().text(""),$(notice).text(wp.i18n.sprintf(wp.i18n.__("Error: %s","gp-project-icon"),response.message)),$(notice).fadeIn())},error:function(response){},complete:function(){}})}gpToolboxTablePermissionAdmin.length&&$(gpToolboxTablePermissionAdmin).children("tbody").children("tr").each(function(){var permissionID=$(this).attr("gptoolboxdata-permission");glotpressAdmin&&($(this).find("td.user").text().trim()===userLogin?$(this).find("td.action button.delete").attr("disabled",!0):$(this).find("td.action button.delete").on("click",function(){confirm(wp.i18n.__("You are about to permanently delete these permission.\nThis action cannot be undone.\n'Cancel' to stop, 'OK' to delete.","gp-project-icon"))&&permissionDelete("admin",permissionID)}))}),gpToolboxTablePermissionValidator.length&&$(gpToolboxTablePermissionValidator).children("tbody").children("tr").each(function(){var permissionID=$(this).attr("gptoolboxdata-permission");glotpressAdmin&&$(this).find("td.action button.delete").on("click",function(){confirm(wp.i18n.__("You are about to permanently delete these permission.\nThis action cannot be undone.\n'Cancel' to stop, 'OK' to delete.","gp-project-icon"))&&permissionDelete("validator",permissionID)})}),$(gpToolboxTablePermissionAdmin).tablesorter({theme:"glotpress",sortList:[[1,0]],headers:{0:{sorter:"text"}}}),$("#permission-admin-filter").bind("change keyup input",function(){var words=this.value.toLowerCase().split(" ");(""===this.value.trim()?permissionAdminsRows:(permissionAdminsRows.hide(),permissionAdminsRows.filter(function(){for(var t=$(this),d=0;d<words.length;++d)if(-1!==t.text().toLowerCase().indexOf(words[d]))return!0;return!1}))).show()}),$(gpToolboxTablePermissionValidator).tablesorter({theme:"glotpress",sortList:[[1,0],[2,0],[3,0]],headers:{0:{sorter:"text"}}}),$("#permission-validator-filter").bind("change keyup input",function(){var words=this.value.toLowerCase().split(" ");(""===this.value.trim()?permissionValidatorsRows:(permissionValidatorsRows.hide(),permissionValidatorsRows.filter(function(){for(var t=$(this),d=0;d<words.length;++d)if(-1!==t.text().toLowerCase().indexOf(words[d]))return!0;return!1}))).show()}),$("button#permission-admin-filter-clear").click(function(){$("input#permission-admin-filter").val(""),$(gpToolboxTablePermissionAdmin).find("tbody tr").show()}),$("button#permission-validator-filter-clear").click(function(){$("input#permission-validator-filter").val(""),$(gpToolboxTablePermissionValidator).find("tbody tr").show()})});